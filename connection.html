<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet Connect</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .wallet-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        .wallet-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            color: #333;
        }

        .wallet-btn:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-2px);
        }

        .wallet-btn:active {
            transform: translateY(0px);
        }

        .wallet-btn.connected {
            border-color: #4caf50;
            background: #e8f5e8;
            color: #2e7d32;
        }

        .wallet-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }

        .metamask-icon {
            background: linear-gradient(135deg, #f6851b, #e2761b);
        }

        .trust-icon {
            background: linear-gradient(135deg, #3375bb, #1e3a8a);
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }

        .status.connected {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            color: #2e7d32;
            display: block;
        }

        .status.error {
            background: #ffebee;
            border: 1px solid #f44336;
            color: #c62828;
            display: block;
        }

        .address {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            word-break: break-all;
            margin-top: 10px;
            padding: 10px;
            background: rgba(255,255,255,0.8);
            border-radius: 8px;
        }

        .disconnect-btn {
            margin-top: 15px;
            padding: 8px 16px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .disconnect-btn:hover {
            background: #ff5252;
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .wallet-btn {
                padding: 12px 16px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Connect Your Wallet</h1>
        
        <div class="wallet-buttons">
            <button class="wallet-btn" id="metamaskBtn">
                <div class="wallet-icon metamask-icon"></div>
                <span id="metamaskText">Connect MetaMask</span>
            </button>
            
            <button class="wallet-btn" id="trustBtn">
                <div class="wallet-icon trust-icon"></div>
                <span id="trustText">Connect Trust Wallet</span>
            </button>
        </div>

        <div class="status" id="status">
            <div id="statusText"></div>
            <div class="address" id="address"></div>
            <button class="disconnect-btn" id="disconnectBtn" style="display: none;">Disconnect</button>
        </div>
    </div>

    <script>
        class WalletConnector {
            constructor() {
                this.connectedWallet = null;
                this.connectedAddress = null;
                this.init();
            }

            init() {
                document.getElementById('metamaskBtn').addEventListener('click', () => this.connectMetaMask());
                document.getElementById('trustBtn').addEventListener('click', () => this.connectTrustWallet());
                document.getElementById('disconnectBtn').addEventListener('click', () => this.disconnect());
                
                // Check if already connected on page load
                this.checkConnection();
            }

            async checkConnection() {
                if (typeof window.ethereum !== 'undefined') {
                    try {
                        const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                        if (accounts.length > 0) {
                            this.connectedAddress = accounts[0];
                            this.updateUI(true, 'Connected', accounts[0]);
                        }
                    } catch (error) {
                        console.log('No existing connection found');
                    }
                }
            }

            async connectMetaMask() {
                if (typeof window.ethereum !== 'undefined') {
                    try {
                        // Request account access
                        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                        
                        if (accounts.length > 0) {
                            this.connectedWallet = 'MetaMask';
                            this.connectedAddress = accounts[0];
                            this.updateUI(true, 'MetaMask Connected', accounts[0]);
                            
                            // Listen for account changes
                            window.ethereum.on('accountsChanged', (accounts) => {
                                if (accounts.length === 0) {
                                    this.disconnect();
                                } else {
                                    this.connectedAddress = accounts[0];
                                    this.updateUI(true, 'MetaMask Connected', accounts[0]);
                                }
                            });
                        }
                    } catch (error) {
                        this.updateUI(false, 'MetaMask connection failed: ' + error.message);
                    }
                } else {
                    // For mobile, try to open MetaMask app
                    if (this.isMobile()) {
                        const dappUrl = encodeURIComponent(window.location.href);
                        window.open(`https://metamask.app.link/dapp/${window.location.host}${window.location.pathname}`, '_blank');
                    } else {
                        this.updateUI(false, 'MetaMask is not installed. Please install MetaMask extension.');
                    }
                }
            }

            async connectTrustWallet() {
                // Trust Wallet uses the same ethereum provider interface
                if (typeof window.ethereum !== 'undefined') {
                    // Check if it's Trust Wallet
                    if (window.ethereum.isTrust || window.trustwallet) {
                        try {
                            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                            
                            if (accounts.length > 0) {
                                this.connectedWallet = 'Trust Wallet';
                                this.connectedAddress = accounts[0];
                                this.updateUI(true, 'Trust Wallet Connected', accounts[0]);
                            }
                        } catch (error) {
                            this.updateUI(false, 'Trust Wallet connection failed: ' + error.message);
                        }
                    } else {
                        // Try generic ethereum connection for Trust Wallet
                        try {
                            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                            
                            if (accounts.length > 0) {
                                this.connectedWallet = 'Trust Wallet';
                                this.connectedAddress = accounts[0];
                                this.updateUI(true, 'Trust Wallet Connected', accounts[0]);
                            }
                        } catch (error) {
                            this.updateUI(false, 'Connection failed: ' + error.message);
                        }
                    }
                } else {
                    // For mobile, try to open Trust Wallet app
                    if (this.isMobile()) {
                        const dappUrl = encodeURIComponent(window.location.href);
                        window.open(`https://link.trustwallet.com/open_url?coin_id=60&url=${dappUrl}`, '_blank');
                    } else {
                        this.updateUI(false, 'Trust Wallet is not installed. Please install Trust Wallet.');
                    }
                }
            }

            disconnect() {
                this.connectedWallet = null;
                this.connectedAddress = null;
                this.updateUI(false, '', '');
            }

            updateUI(connected, statusText, address = '') {
                const status = document.getElementById('status');
                const statusTextEl = document.getElementById('statusText');
                const addressEl = document.getElementById('address');
                const disconnectBtn = document.getElementById('disconnectBtn');
                const metamaskBtn = document.getElementById('metamaskBtn');
                const trustBtn = document.getElementById('trustBtn');
                const metamaskText = document.getElementById('metamaskText');
                const trustText = document.getElementById('trustText');

                if (connected) {
                    status.className = 'status connected';
                    statusTextEl.textContent = statusText;
                    addressEl.textContent = `Address: ${address}`;
                    disconnectBtn.style.display = 'inline-block';
                    
                    // Update button states
                    if (this.connectedWallet === 'MetaMask') {
                        metamaskBtn.classList.add('connected');
                        metamaskText.textContent = '✓ MetaMask Connected';
                        trustBtn.classList.remove('connected');
                        trustText.textContent = 'Connect Trust Wallet';
                    } else if (this.connectedWallet === 'Trust Wallet') {
                        trustBtn.classList.add('connected');
                        trustText.textContent = '✓ Trust Wallet Connected';
                        metamaskBtn.classList.remove('connected');
                        metamaskText.textContent = 'Connect MetaMask';
                    }
                } else {
                    if (statusText.includes('failed') || statusText.includes('not installed')) {
                        status.className = 'status error';
                        statusTextEl.textContent = statusText;
                        addressEl.textContent = '';
                    } else {
                        status.className = 'status';
                    }
                    
                    disconnectBtn.style.display = 'none';
                    metamaskBtn.classList.remove('connected');
                    trustBtn.classList.remove('connected');
                    metamaskText.textContent = 'Connect MetaMask';
                    trustText.textContent = 'Connect Trust Wallet';
                }
            }

            isMobile() {
                return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            }
        }

        // Initialize the wallet connector when the page loads
        window.addEventListener('load', () => {
            new WalletConnector();
        });
    </script>
</body>
</html>
